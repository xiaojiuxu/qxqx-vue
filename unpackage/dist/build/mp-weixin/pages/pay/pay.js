(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/pay/pay"],{"1d55":function(e,t,i){},"3d96":function(e,t,i){"use strict";i.r(t);var a=i("b4d9"),n=i("dae4");for(var o in n)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(o);i("a4eb");var s=i("828b"),r=Object(s["a"])(n["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],void 0);t["default"]=r.exports},"6f66":function(e,t,i){"use strict";(function(e,t){var a=i("47a9");i("fc20");a(i("3240"));var n=a(i("3d96"));e.__webpack_require_UNI_MP_PLUGIN__=i,t(n.default)}).call(this,i("3223")["default"],i("df3c")["createPage"])},a4eb:function(e,t,i){"use strict";var a=i("1d55"),n=i.n(a);n.a},b4d9:function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return n})),i.d(t,"a",(function(){}));var a=function(){var e=this,t=e.$createElement,i=(e._self._c,"isCar"!=e.isCar?e.__map(e.live_info,(function(t,i){var a=e.__get_orig(t),n=void 0!=t.sort&&1!=t.islive?t.lesson.length:null;return{$orig:a,g0:n}})):null),a="isCar"==e.isCar?e.__map(e.carinfo,(function(t,i){var a=e.__get_orig(t),n=void 0!=t.sort&&1!=t.islive?t.lesson.length:null;return{$orig:a,g1:n}})):null;e.$mp.data=Object.assign({},{$root:{l0:i,l1:a}})},n=[]},dae4:function(e,t,i){"use strict";i.r(t);var a=i("fa37"),n=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(o);t["default"]=n.a},fa37:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=getApp(),a={data:function(){return{live_info:{},checkstatus:{},allmoney:0,ismaterial:0,hasdefaddress:!1,isCar:"0",carinfo:[],addressdic:{},showpayview:!1,showjifen:!1,payinfo:[],payselected:0,deduct_integral:0,deduct_money:0,jifen_sel:!0,jifen_image_unsel:"../../static/car_1.png",jifen_image_sel:"../../static/car_2.png"}},onReady:function(){},onShow:function(){this.getaddress()},onLoad:function(t){var i=this;if(e.getStorage({key:"openid",success:function(e){getApp().globalData.openid=e.data,console.log(e.data)}}),this.isCar=t.isCar,"isCar"!=this.isCar){console.log("不是从购物车车过来"),console.log(t),this.live_info=JSON.parse(decodeURIComponent(t.info)),void 0==this.live_info[0].sort?this.allmoney=this.live_info[0].price:this.allmoney=this.live_info[0].payval;for(var a=0;a<this.live_info.length;a++){var n=this.live_info[a];1==n.ismaterial&&(this.ismaterial=1)}}else{this.carinfo=JSON.parse(decodeURIComponent(t.info)),this.allmoney=t.money;for(var o=0;o<this.carinfo.length;o++){n=this.carinfo[o];1==n.ismaterial&&(this.ismaterial=1)}}this.getaddress();var s=[],r=[];s="isCar"!=this.isCar?this.live_info:this.carinfo;for(var d=0;d<s.length;d++){n=s[d];var l={};void 0==n.sort?(l["type"]="1",l["typeid"]=n.id):(l["type"]="0",l["typeid"]=n.id),r.push(l)}var f=JSON.stringify(r),c=getApp().globalData;e.request({url:c.site_url+"Cart.getDeduct",method:"POST",data:{uid:c.userinfo.id,token:c.userinfo.token,goods:f},success:function(e){if(0==e.data.data.code){var t=parseFloat(e.data.data.info[0].deduct_integral);i.deduct_money=e.data.data.info[0].deduct_money,t>0&&(i.showjifen=!0,i.allmoney-=i.deduct_money)}}})},methods:{jifensel_unsel:function(){this.jifen_sel=!this.jifen_sel,1==this.jifen_sel?this.allmoney-=this.deduct_money:this.allmoney+=this.deduct_money},pushaddress:function(){e.navigateTo({url:"../address/address"})},cancle:function(){this.showpayview=!1},selectedpayway:function(e){this.payselected=e},fufei:function(){this.buy("wx","3")},buy:function(t,i){var a=this;if("wx"==t&&"3"==i);else if("wx"!=t||"4"!=i)return;var n=[],o=[];n="isCar"!=this.isCar?this.live_info:this.carinfo;for(var s=0;s<n.length;s++){var r=n[s],d={};void 0==r.sort?(d["type"]="1",d["typeid"]=r.id):(d["type"]="0",d["typeid"]=r.id),o.push(d)}var l=JSON.stringify(o),f=getApp().globalData;e.request({url:f.site_url+"Cart.Buy",method:"POST",data:{uid:f.userinfo.id,token:f.userinfo.token,goods:l,payid:i,addrid:"",openid:getApp().globalData.openid,method:this.isCar},success:function(t){if(0==t.data.data.code){if(0==a.allmoney)return e.showToast({title:"支付成功",icon:"none"}),void e.navigateBack({delta:1});t.data.data.info[0].ali,t.data.data.info[0].wx;var i=t.data.data.info[0].small;console.log(t),console.log(i);t.data.data.info[0].orderid,t.data.data.info[0].money;e.requestPayment({provider:"wxpay",timeStamp:String(i.timeStamp),nonceStr:i.nonceStr,package:i.package,signType:"MD5",paySign:i.sign,success:function(t){e.showToast({title:"支付成功",icon:"none"}),e.navigateBack({delta:1}),console.log("success:"+JSON.stringify(t))},fail:function(t){e.showToast({title:"支付失败",icon:"none"}),console.log("fail:"+JSON.stringify(t))}})}else console.log(t),e.showToast({title:t.data.data.msg,icon:"none"})}})},getaddress:function(){var t=this;if(1==this.ismaterial){console.log("GetList");var a=i.globalData;e.request({url:a.site_url+"Addr.GetList",method:"GET",data:{uid:a.userinfo.id,token:a.userinfo.token},success:function(e){var i=e.data.data.info;if(console.log(i),i.length>0){t.hasdefaddress=!0;for(var a=0;a<i.length;a++){var n=i[a];1==n.isdef&&(t.addressdic=n)}}else t.hasdefaddress=!1}})}}}};t.default=a}).call(this,i("df3c")["default"])}},[["6f66","common/runtime","common/vendor"]]]);