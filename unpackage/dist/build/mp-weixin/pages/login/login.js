(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{"339d":function(e,t,a){},"637e":function(e,t,a){"use strict";var n=a("339d"),i=a.n(n);i.a},"8a04":function(e,t,a){"use strict";(function(e){var n=a("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("3704")),o=getApp(),s={components:{uniStatusBar:function(){a.e("components/uni-ui/uni-status-bar/uni-status-bar").then(function(){return resolve(a("a468"))}.bind(null,a)).catch(a.oe)},otherLogin:function(){a.e("components/common/other-login").then(function(){return resolve(a("aee4"))}.bind(null,a)).catch(a.oe)}},data:function(){return{agree:!1,iswechat:1,status:"",login_by_wx:!1,login_by_qq:!1,username:"",usernameFlag:"",password:"",phone:"",code:"",codeTime:0,loginType:"",placeholder:"请输入验证码",get_captcha_txt:"",foretPass:"",isForgetShow:!1,smsType:0,sign:"",jumpPage:"",keyword:"",unionid:"",nickName:"",avatar:"",canshowcode:!1}},onReady:function(){this.iswechat=0,this.login_by_wx=!0},onLoad:function(t){""!=t.page&&(this.jumpPage=t.page),""!=t.keyword&&(this.keyword=t.keyword);var a=e.getSystemInfoSync(),n=a.statusBarHeight;this.statusBarHeight=n,this.loginType="captcha",this.get_captcha_txt="获取验证码"},computed:{enabled:function(){return""==this.username||""==this.password}},methods:{username_input:function(e){11==e.detail.value.length?this.canshowcode=!0:this.canshowcode=!1},agreeme:function(){1==this.agree?this.agree=!1:this.agree=!0},gotoxieyi:function(t){"1"==t?e.navigateTo({url:"../login/xieyi?type=4",success:function(e){},fail:function(){},complete:function(){}}):e.navigateTo({url:"../login/xieyi?type=5",success:function(e){},fail:function(){}})},qqlogin:function(){if(0!=this.agree);else e.showToast({title:"请阅读并同意相关协议",icon:"none"})},wechatlogin:function(){var t=this;if(0!=this.agree){var a=o.globalData;e.showLoading({title:"登录中...",mask:!1});var n=this;e.login({success:function(i){e.hideLoading(),n.code=i.code,e.getUserInfo({success:function(i){var s=JSON.parse(i.rawData);t.nickName=s.nickName,t.avatar=s.avatarUrl,e.request({url:a.site_url+"App.Login.getUnionid",method:"GET",data:{code:n.code},success:function(t){var a=t.data.data.openid;o.globalData.openid=a,e.setStorage({key:"openid",data:a,success:function(){}}),n.thirdlogin(a,n.nickName,n.avatar,2,3)}})}})}})}else e.showToast({title:"请阅读并同意相关协议",icon:"none"})},thirdlogin:function(t,a,n,i,s){e.showLoading({title:"加载中",mask:!1});var r=this.sort2url({openid:t,type:i});e.request({url:o.globalData.site_url+"Login.LoginByThird",method:"POST",data:{openid:t,source:s,type:i,nicename:a,avatar:n,sign:r},success:function(t){e.hideLoading(),e.showToast({icon:"none",title:t.data.data.msg,duration:2e3}),0===parseInt(t.data.data.code)&&(o.globalData.userinfo=t.data.data.info[0],e.setStorage({key:"userinfo",data:t.data.data.info[0],success:function(){}}),setTimeout((function(){var t="../index/index",a=o.globalData;""!=a.login_jump.page&&(t=a.login_jump.page),e.reLaunch({url:t})}),2e3))}})},register:function(){e.navigateTo({url:"../reg/reg"})},back:function(){e.reLaunch({url:"../index/index"})},initForm:function(){this.username="",this.password="",this.phone="",this.code="",this.isForgetShow=!1},chanloginType:function(e){"captcha"==e?(this.loginType="captcha",this.placeholder="请输入验证码",this.get_captcha_txt="获取验证码",this.foretPass="",this.isForgetShow=!1):"pass"==e&&(this.loginType="pass",this.placeholder="请输入密码",this.get_captcha_txt="",this.foretPass="忘记密码",this.isForgetShow=!0)},getSmsCode:function(){var t=this;if(this.usernameFlag==this.username&&this.codeTime>0)e.showToast({icon:"none",title:"验证码5分钟有效, 请勿多次发送"});else if(this.validate()){var a=this.sort2url({account:this.username});e.request({url:o.globalData.site_url+"Login.GetCode",data:{account:this.username,type:this.smsType,sign:a,env:"weixin"},success:function(a){e.showToast({icon:"none",title:a.data.data.msg}),0===parseInt(a.data.data.code)&&(t.codeTime=300,t.usernameFlag=t.username)}});var n=setInterval((function(){t.codeTime>=1?t.codeTime--:(t.codeTime=0,clearInterval(n))}),1e3)}},validate:function(){return this.phone=this.username,!!/^1[3456789][0-9]\d{8}$/.test(this.phone)||(e.showToast({title:"手机号格式不正确",icon:"none",duration:2e3}),!1)},sort2url:function(e){for(var t=Object.keys(e).sort(),a={},n=0;n<t.length;n++)a[t[n]]=e[t[n]];var s="";for(var r in a)s=s+r+"="+a[r]+"&";return s=s.substr(0,s.length-1),s+="&"+o.globalData.sign_key,i.default.hex_md5(s)},submit:function(){if(0!=this.agree){var t,a;if("captcha"==this.loginType){if(!this.validate())return;var n=this.sort2url({username:this.username});t=o.globalData.site_url+"Login.LoginByCode",a={username:this.username,code:this.password,source:3,sign:n,env:"weixin"}}else t=o.globalData.site_url+"Login.Login",a={username:this.username,pass:this.password};e.showLoading({title:"",mask:!1}),e.request({url:t,data:a,success:function(t){e.hideLoading(),e.showToast({icon:"none",title:t.data.data.msg,duration:2e3}),0===parseInt(t.data.data.code)&&(o.globalData.userinfo=t.data.data.info[0],e.setStorage({key:"userinfo",data:t.data.data.info[0],success:function(){}}),setTimeout((function(){var t="../index/index",a=o.globalData;""!=a.login_jump.page&&(t=a.login_jump.page),e.reLaunch({url:t})}),0))},fail:function(){e.hideLoading(),e.showToast({title:"网络错误",icon:"none"})}})}else e.showToast({title:"请阅读并同意相关协议",icon:"none"})}}};t.default=s}).call(this,a("df3c")["default"])},"8fd7":function(e,t,a){"use strict";(function(e,t){var n=a("47a9");a("fc20");n(a("3240"));var i=n(a("ee49"));e.__webpack_require_UNI_MP_PLUGIN__=a,t(i.default)}).call(this,a("3223")["default"],a("df3c")["createPage"])},ee0b:function(e,t,a){"use strict";a.r(t);var n=a("8a04"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t["default"]=i.a},ee49:function(e,t,a){"use strict";a.r(t);var n=a("f1bf"),i=a("ee0b");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("637e");var s=a("828b"),r=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);t["default"]=r.exports},f1bf:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){}));var n=function(){var e=this.$createElement;this._self._c},i=[]}},[["8fd7","common/runtime","common/vendor"]]]);